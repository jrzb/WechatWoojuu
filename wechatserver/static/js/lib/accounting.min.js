/*! wechat.woojuu.cc 2013-05-18 */
(function(t,e){function n(t){return!!(""===t||t&&t.charCodeAt&&t.substr)}function r(t){return d?d(t):"[object Array]"===l.call(t)}function i(t){return"[object Object]"===l.call(t)}function s(t,e){var n;t=t||{},e=e||{};for(n in e)e.hasOwnProperty(n)&&null==t[n]&&(t[n]=e[n]);return t}function a(t,e,n){var r,i,s=[];if(!t)return s;if(c&&t.map===c)return t.map(e,n);for(r=0,i=t.length;i>r;r++)s[r]=e.call(n,t[r],r,t);return s}function o(t,e){return t=Math.round(Math.abs(t)),isNaN(t)?e:t}function u(t){var e=h.settings.currency.format;return"function"==typeof t&&(t=t()),n(t)&&t.match("%v")?{pos:t,neg:t.replace("-","").replace("%v","-%v"),zero:t}:t&&t.pos&&t.pos.match("%v")?t:n(e)?h.settings.currency.format={pos:e,neg:e.replace("%v","-%v"),zero:e}:e}var h={};h.version="0.3.2",h.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var c=Array.prototype.map,d=Array.isArray,l=Object.prototype.toString,f=h.unformat=h.parse=function(t,e){if(r(t))return a(t,function(t){return f(t,e)});if(t=t||0,"number"==typeof t)return t;e=e||".";var n=RegExp("[^0-9-"+e+"]",["g"]),i=parseFloat((""+t).replace(/\((.*)\)/,"-$1").replace(n,"").replace(e,"."));return isNaN(i)?0:i},m=h.toFixed=function(t,e){e=o(e,h.settings.number.precision);var n=Math.pow(10,e);return(Math.round(h.unformat(t)*n)/n).toFixed(e)},y=h.formatNumber=function(t,e,n,u){if(r(t))return a(t,function(t){return y(t,e,n,u)});t=f(t);var c=s(i(e)?e:{precision:e,thousand:n,decimal:u},h.settings.number),d=o(c.precision),l=0>t?"-":"",g=parseInt(m(Math.abs(t||0),d),10)+"",p=g.length>3?g.length%3:0;return l+(p?g.substr(0,p)+c.thousand:"")+g.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+c.thousand)+(d?c.decimal+m(Math.abs(t),d).split(".")[1]:"")},g=h.formatMoney=function(t,e,n,c,d,l){if(r(t))return a(t,function(t){return g(t,e,n,c,d,l)});t=f(t);var m=s(i(e)?e:{symbol:e,precision:n,thousand:c,decimal:d,format:l},h.settings.currency),p=u(m.format),v=t>0?p.pos:0>t?p.neg:p.zero;return v.replace("%s",m.symbol).replace("%v",y(Math.abs(t),o(m.precision),m.thousand,m.decimal))};h.formatColumn=function(t,e,c,d,l,m){if(!t)return[];var g=s(i(e)?e:{symbol:e,precision:c,thousand:d,decimal:l,format:m},h.settings.currency),p=u(g.format),v=p.pos.indexOf("%s")<p.pos.indexOf("%v")?!0:!1,M=0,D=a(t,function(t){if(r(t))return h.formatColumn(t,g);t=f(t);var e=t>0?p.pos:0>t?p.neg:p.zero,n=e.replace("%s",g.symbol).replace("%v",y(Math.abs(t),o(g.precision),g.thousand,g.decimal));return n.length>M&&(M=n.length),n});return a(D,function(t){return n(t)&&M>t.length?v?t.replace(g.symbol,g.symbol+Array(M-t.length+1).join(" ")):Array(M-t.length+1).join(" ")+t:t})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports.accounting=h):"function"==typeof define&&define.amd?define([],function(){return h}):(h.noConflict=function(n){return function(){return t.accounting=n,h.noConflict=e,h}}(t.accounting),t.accounting=h)})(this);